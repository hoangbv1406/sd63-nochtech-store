<!-- File: product.admin.component.html -->
<main class="container-fluid">
    <div class="product-container">

        <div class="action-bar">
            <div class="action-left">
                <div class="search-box">
                    <input type="text" placeholder="Tìm kiếm sản phẩm..." [(ngModel)]="keyword" (keyup.enter)="searchProducts()">
                    <i class="fa-solid fa-magnifying-glass" (click)="searchProducts()"></i>
                </div>
                <div class="filter-wrapper">
                    <button class="btn-filter" id="filterBtn">
                        <i class="fa-solid fa-filter"></i>
                    </button>
                </div>
            </div>
            <button class="btn-add" (click)="insertProduct()">
                <i class="fa-solid fa-plus"></i>
                <span>Thêm sản phẩm</span>
            </button>
        </div>

        <div class="table-responsive">
            <table class="product-table">
                <thead>
                    <tr>
                        <th><input type="checkbox"></th>
                        <th>ID</th>
                        <th>Hình ảnh</th>
                        <th>Tên sản phẩm</th>
                        <th>Danh mục</th>
                        <th>Giá bán</th>
                        <th>Kho</th>
                        <th>Trạng thái</th>
                        <th>Hành động</th>
                    </tr>
                </thead>
                <tbody>
                    @for(product of products; track product.id) {
                    <tr>
                        <td><input type="checkbox"></td>
                        <td><span class="id-text">{{ product.id }}</span></td>
                        <td>
                            <div class="product-thumbnail">
                                @if(product.url) {
                                <img [src]="product.url" alt="product">
                                } @else {
                                <i class="fa-regular fa-image"></i>
                                }
                            </div>
                        </td>
                        <td><span class="name-text">{{ product.name }}</span></td>
                        <td><span class="cate-text">{{ product.category_name || 'Chưa phân loại' }}</span></td>
                        <td><span class="price-text">{{ product.price | number:'1.0-0'}}₫</span></td>
                        <td>null</td>
                        <td><span class="badge status-active">Còn hàng</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-icon btn-edit" title="Sửa" (click)="updateProduct(product.id)">
                                    <i class="fa-solid fa-pen"></i>
                                </button>
                                <button class="btn-icon btn-delete" title="Xóa" (click)="deleteProduct(product)">
                                    <i class="fa-solid fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    }
                </tbody>
            </table>
        </div>

        <div class="table-footer">
            <div class="footer-left">
                <span>Trang {{ currentPage + 1 }} / {{ totalPages }}</span>
            </div>
            <div class="footer-right">
                <div class="page-size">
                    <span>Xem</span>
                    <select class="page-select" [(ngModel)]="itemsPerPage" (change)="searchProducts()">
                        <option [ngValue]="10">10</option>
                        <option [ngValue]="25">25</option>
                        <option [ngValue]="50">50</option>
                    </select>
                    <span>mục</span>
                </div>

                <nav class="pagination-nav">
                    <button class="btn-page" (click)="onPageChange(currentPage - 1)"
                        [disabled]="currentPage === 0" [class.disabled]="currentPage === 0">
                        <i class="fa-solid fa-chevron-left"></i>
                    </button>

                    @for(page of visiblePages; track page) {
                    <button class="btn-page" [class.active]="page === currentPage" (click)="onPageChange(page)">
                        {{ page + 1 }}
                    </button>
                    }

                    <button class="btn-page" (click)="onPageChange(currentPage + 1)"
                        [disabled]="currentPage >= totalPages - 1" [class.disabled]="currentPage >= totalPages - 1">
                        <i class="fa-solid fa-chevron-right"></i>
                    </button>
                </nav>
            </div>
        </div>

    </div>
</main>